<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.atzuche.order.admin.mapper.log.AdminOperateLogMapper">

    <resultMap id="base" type="com.atzuche.order.admin.entity.AdminOperateLogEntity" >
        <id property="id" column="id"/>
        <result property="orderNo" column="order_no"/>
        <result property="renterOrderNo" column="renter_order_no"/>
        <result property="ownerOrderNo" column="owner_order_no"/>
        <result property="operatorId" column="operator_id"/>
        <result property="operatorName" column="operator_name"/>
        <result property="deptId" column="dept_id"/>
        <result property="opTypeCode" column="op_type_code"/>
        <result property="opTypeDesc" column="op_type_desc"/>
        <result property="desc" column="desc"/>
        <result property="createTime" column="create_time"/>
    </resultMap>

	<insert id="insertLog">
        insert into
        order_console_operate_log(order_no,`renter_order_no`,`owner_order_no`,operator_id,operator_name,dept_id,op_type_code,op_type_desc,`desc`)
        values(#{orderNo},#{renterOrderNo}, #{ownerOrderNo}	,#{operatorId},#{operatorName},#{deptId},#{opTypeCode},#{opTypeDesc},#{desc})

	</insert>

	<select id="findAll" resultMap="base">
		select
		    `id`,
		    `order_no`,
            `renter_order_no`,
            `owner_order_no`,
		    `operator_name`,
		    `dept_id`,
		    `op_type_code`,
		    `op_type_desc`,
		    `desc`,
		    `create_time`
		from order_console_operate_log where order_no=#{orderNo} and is_delete=0 order by create_time desc
	</select>

    <select id="findByQuery" resultMap="base">
        select
            `id`,
            `order_no`,
            `renter_order_no`,
            `owner_order_no`,
            `operator_name`,
            `dept_id`,
            `op_type_code`,
            `op_type_desc`,
            `desc`,
            `create_time`
		from
		    order_console_operate_log
		where
		    order_no = #{orderNo}
		    and is_delete=0
            <if test="startTime != null and  endTime != null">
                and create_time between #{startTime} and #{endTime}
            </if>
            <if test="content != null and  content != ''">
                and `desc` like concat(#{content},'%')
            </if>
            <if test="opType != null and  opType != ''">
                and op_type_code = #{opType}
            </if>
            <if test="operatorName != null and  operatorName != ''">
                and operator_name = #{operatorName}
            </if>
    </select>


</mapper>